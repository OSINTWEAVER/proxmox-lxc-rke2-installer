[rke2_cluster:children]
rke2_servers
rke2_agents

[rke2_cluster:vars]
# Basic cluster configuration
# IMPORTANT: Generate a secure random token before deployment
rke2_token=CHANGE-THIS-TO-SECURE-RANDOM-TOKEN
rke2_api_ip=10.14.100.1
rke2_version=v1.30.6+rke2r1

# SQLITE MODE FOR LXC CONTAINERS
# This is recommended when deploying in LXC containers to avoid etcd issues
# Note: This mode only supports a single server node, not HA clusters
rke2_use_sqlite=true

# Disable HA mode when using SQLite (SQLite is single-server only)
rke2_ha_mode=false

# Compatibility variable for the role
k8s_cluster=rke2_cluster

# Network configuration for VLAN 14
cluster_cidr=10.42.0.0/16
service_cidr=10.43.0.0/16
cluster_dns=10.43.0.10

# Configurable naming (maintains backward compatibility)
node_name_prefix=os-env-
gpu_node_pattern=gpu

# The file where to store the Kubernetes client configuration
rke2_download_kubeconf_file_name=hosts.yaml

# Configure the local-path-provisioner StorageClass
use_local_path_provisioner=true

# Storage configuration
local_path_provisioner_path=/mnt/data

# Rancher UI installation - DISABLED (using k9s for diagnostics instead)
install_rancher=false
# rancher_hostname=rancher.local
# rancher_bootstrap_password=CHANGE-THIS-PASSWORD

# Compatibility variable for ansible-role-rke2
k8s_cluster=rke2_cluster

# SQLite-specific optimizations
rke2_cni=flannel
disable_kube_proxy=false

# Disable components that are not needed in SQLite mode
rke2_disable:
  - rke2-canal
  - rke2-ingress-nginx
  - rke2-metrics-server

[rke2_servers]
# Control plane machine (SQLite mode supports only one server)
10.14.100.1 ansible_user=adm4n rke2_type=server

[rke2_agents]
# GPU worker nodes (automatically detected by gpu_node_pattern)
10.14.100.2 ansible_user=adm4n rke2_type=agent
10.14.100.3 ansible_user=adm4n rke2_type=agent

[all:vars]
# SSH and privilege escalation configuration for passwordless operation
ansible_ssh_private_key_file=~/.ssh/id_ed25519
ansible_ssh_common_args='-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null'
ansible_become=yes
ansible_become_method=sudo
ansible_become_user=root
ansible_become_pass=
